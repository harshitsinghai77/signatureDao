{"ast":null,"code":"import _regeneratorRuntime from \"/home/harshitsinghai/Documents/Projects/web3/signature-dao/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/harshitsinghai/Documents/Projects/web3/signature-dao/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/harshitsinghai/Documents/Projects/web3/signature-dao/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/** @jsx jsx */\nimport { useState, useEffect, useContext } from \"react\";\nimport { jsx, Box, Container, Flex, Button } from \"theme-ui\";\nimport Sticky from \"react-stickynode\";\nimport { Web3Provider } from \"@ethersproject/providers\";\nimport { DrawerProvider } from \"contexts/drawer/drawer-provider\";\nimport NavbarDrawer from \"./navbar-drawer\";\nimport Logo from \"components/logo\";\nimport { getWeb3Modal, switchNetwork } from \"utils/web3connect\";\nimport { Web3CreateContext } from \"contexts/web3-context\";\nimport { SET_WEB3_PROVIDER, RESET_WEB3_PROVIDER, SET_CHAIN_ID, SET_ADDRESS } from \"contexts/web3-constants\";\nimport { CURRENT_NETWORK } from \"utils/constants\";\nexport default function Header() {\n  var _useContext = useContext(Web3CreateContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var provider = state.provider,\n      address = state.address,\n      chainId = state.chainId;\n\n  var _useState = useState(),\n      web3Modal = _useState[0],\n      setWeb3Modal = _useState[1];\n\n  var _useState2 = useState({\n    isMobileMenu: false,\n    isSticky: false\n  }),\n      stateMobile = _useState2[0],\n      setState = _useState2[1];\n\n  var handleCloseMenu = function handleCloseMenu() {\n    setState(_objectSpread(_objectSpread({}, stateMobile), {}, {\n      isMobileMenu: false\n    }));\n  };\n\n  var onWeb3Connect = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _provider, web3Provider, signer, _address, network;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (web3Modal) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              _context.prev = 2;\n              _context.next = 5;\n              return web3Modal.connect();\n\n            case 5:\n              _provider = _context.sent;\n              // We plug the initial `provider` into ethers.js and get back\n              // a Web3Provider. This will add on methods from ethers.js and\n              // event listeners such as `.on()` will be different.\n              web3Provider = new Web3Provider(_provider, \"any\");\n              signer = web3Provider.getSigner();\n              _context.next = 10;\n              return signer.getAddress();\n\n            case 10:\n              _address = _context.sent;\n              _context.next = 13;\n              return web3Provider.getNetwork();\n\n            case 13:\n              network = _context.sent;\n              dispatch({\n                type: SET_WEB3_PROVIDER,\n                provider: _provider,\n                web3Provider: web3Provider,\n                address: _address,\n                chainId: network.chainId\n              });\n              _context.next = 20;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(\"Web3Error caught\", _context.t0);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 17]]);\n    }));\n\n    return function onWeb3Connect() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var onWeb3Disconnect = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return web3Modal.clearCachedProvider();\n\n            case 2:\n              if (!(provider !== null && provider !== void 0 && provider.disconnect && typeof provider.disconnect === \"function\")) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 5;\n              return provider.disconnect();\n\n            case 5:\n              dispatch({\n                type: RESET_WEB3_PROVIDER\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function onWeb3Disconnect() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (provider) {\n      var handleChainChanged = function handleChainChanged(chainId) {\n        chainId = parseInt(chainId, 16);\n        dispatch({\n          type: SET_CHAIN_ID,\n          chainId: chainId\n        });\n      };\n\n      var handleAccountChanged = function handleAccountChanged(accounts) {\n        dispatch({\n          type: SET_ADDRESS,\n          address: accounts[0]\n        });\n      };\n\n      provider.on(\"chainChanged\", handleChainChanged);\n      provider.on(\"accountsChanged\", handleAccountChanged); // Subscription Cleanup\n\n      return function () {\n        if (provider.removeListener) {\n          provider.removeListener(\"chainChanged\", handleChainChanged);\n        }\n      };\n    }\n  }, [provider]);\n  useEffect(function () {\n    var web3Modal = getWeb3Modal();\n    setWeb3Modal(web3Modal);\n  }, []);\n  return jsx(DrawerProvider, null, jsx(Box, {\n    sx: styles.headerWrapper\n  }, jsx(Sticky, {\n    enabled: true,\n    top: 0,\n    activeClass: \"is-sticky\",\n    innerZ: 100\n  }, jsx(Box, {\n    as: \"header\",\n    variant: \"layout.header\",\n    className: stateMobile.isMobileMenu ? \"is-mobile-menu\" : \"\"\n  }, jsx(Container, null, jsx(Box, {\n    sx: styles.headerInner\n  }, jsx(Logo, {\n    sx: styles.logo,\n    isSticky: stateMobile.isSticky\n  }), jsx(Flex, {\n    as: \"nav\",\n    sx: styles.navbar,\n    className: stateMobile.isMobileMenu ? \"navbar active\" : \"navbar\"\n  }, jsx(Box, {\n    as: \"ul\",\n    sx: styles.navList,\n    className: stateMobile.isMobileMenu ? \"active\" : \"\"\n  })), jsx(Flex, null, provider && !(chainId === (CURRENT_NETWORK === null || CURRENT_NETWORK === void 0 ? void 0 : CURRENT_NETWORK.chainId)) && jsx(Button, {\n    variant: \"text\",\n    sx: styles.error,\n    onClick: switchNetwork\n  }, \"Change to \", CURRENT_NETWORK === null || CURRENT_NETWORK === void 0 ? void 0 : CURRENT_NETWORK.name), address && jsx(Button, {\n    variant: \"text\",\n    sx: styles.getStarted\n  }, address.substring(0, 4) + \"...\" + address.substring(address.length - 3, address.length)), provider ? jsx(Button, {\n    variant: \"text\",\n    sx: styles.getStarted,\n    onClick: onWeb3Disconnect\n  }, \"Disconnect\") : jsx(Button, {\n    variant: \"text\",\n    sx: styles.getStarted,\n    onClick: onWeb3Connect\n  }, \"Connect\")), jsx(NavbarDrawer, null)))))));\n}\nvar styles = {\n  headerWrapper: {\n    justifyContent: \"space-between\",\n    backgroundColor: \"#FFFCF7\",\n    header: {\n      position: \"fixed\",\n      left: 0,\n      right: 0,\n      py: [4],\n      transition: \"all 0.3s ease-in-out 0s\",\n      \"&.is-mobile-menu\": {\n        backgroundColor: \"white\"\n      }\n    },\n    \".is-sticky\": {\n      header: {\n        backgroundColor: \"white\",\n        py: [\"13px\"],\n        boxShadow: \"0 6px 13px rgba(38,78,118,0.1)\"\n      }\n    }\n  },\n  headerInner: {\n    display: \"flex\",\n    // alignItems: \"center\",\n    justifyContent: \"space-between\",\n    position: [\"relative\", null, null, \"static\"]\n  },\n  logo: {\n    mr: [null, null, null, null, 30, 12]\n  },\n  navbar: {\n    display: [\"none\", null, null, null, \"flex\"],\n    alignItems: \"center\",\n    flexGrow: 1,\n    // justifyContent: 'center',\n    li: {\n      display: \"flex\",\n      alignItems: \"center\",\n      a: {\n        cursor: \"pointer\",\n        transition: \"all 0.3s ease-in-out 0s\"\n      }\n    }\n  },\n  navList: {\n    display: [\"flex\"],\n    listStyle: \"none\",\n    flexGrow: 1,\n    p: 0,\n    \".nav-item\": {\n      cursor: \"pointer\",\n      fontWeight: 400,\n      padding: 0,\n      margin: [null, null, null, null, \"0 15px\"]\n    },\n    \".active\": {\n      color: \"primary\"\n    }\n  },\n  getStarted: {\n    backgroundColor: \"#FFF0D7\",\n    color: \"#E6A740\",\n    p: [\"0 16px\"],\n    minHeight: 45,\n    ml: [6],\n    display: [\"none\", null, null, null, \"flex\"]\n  },\n  error: {\n    backgroundColor: \"#ffd7dd\",\n    color: \"#e64040\",\n    p: [\"0 16px\"],\n    minHeight: 45,\n    ml: [6],\n    display: [\"none\", null, null, null, \"flex\"]\n  }\n};","map":null,"metadata":{},"sourceType":"module"}